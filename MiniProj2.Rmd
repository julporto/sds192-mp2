---
title: "Mini Project 2"
authors: "Dasom An & Julia Portocarrero"
date: "March 23, 2018"
output: 
  html_document:
    code_folding: hide
---

This document will try to answer the question: **In what states do committees contribute the most and least to campaigns, on average?**


#### Load data: 

The data on contributions to candidates comes from the Federal Election Committee. The unit is dollars. The data on the population of each state comes from census data of the same year (https://www.census.gov/data/datasets/2017/demo/popest/state-total.html).

We calculated the average contributions from each state, and divided it by the state population to account for size differences. However, it is important to keep in mind that the contributions are from Committees, not individuals- using the population was our way of trying to control for different number of committees per state.  

```{r, messages = FALSE, warning = FALSE}
library(tidyverse)
library(dplyr)

load("contributions.rda")

census_data <- read.csv("census_Data.csv") %>%
  select(state, X2017)
```

#### Modify the data table:

We simplified the large data table to include the transaction amount and the state the transaction came from. We then found the mean transaction amount for each state.
```{r}
 #create data table with average contribution by state
state_contrib <- contributions %>%
  select(transaction_amt, state) %>%
  group_by(state) %>%
  summarize(avg_donation = mean(transaction_amt))
```

Join the data: We combined our data table with the mean transactions with a data table containing the population for each state, and calculated the average donation of committees by population.

```{r, warning = FALSE}
#create data table that divides avg state donation by state population

state_contrib_census <- left_join(state_contrib, census_data, by = "state", na.rm = TRUE)

full_data <- state_contrib_census %>%
  mutate(donation_per_person = as.numeric(avg_donation)/as.numeric(X2017)) %>% 
  na.omit()
```

Most and Least donations: In order to look at the most interesting values, we made data sets containing the data for the 10 states who contributed the most and the least to campaigns. 

```{r}
most_data <- full_data %>%
  arrange(desc(donation_per_person)) %>%
  head(5)
  
least_data<- full_data %>%
  arrange(donation_per_person) %>%
  head(5)

total_data <- rbind(most_data, least_data) #it's hard to see the numbers when you look at both together- better to have seperate graphs
```

#### Plot

The graph shows the 10 states with the most and least contributions to candidates. This data is for 2017. 

```{r}
#This function graphs the data
graph_funct <- function(data) { 
  plot <- ggplot(data) +
  geom_col(aes(x = reorder(state, -donation_per_person), y = donation_per_person), show.legend=F) +
  ylab("Avg donation per person ($)") +
  xlab("State")
  return(plot)
}
```

```{r}
graph_funct(total_data) +
  labs(title="The Most and Least 10 Contributing States in 2017")
```

Since it's hard to estimate the numbers for the smaller values, the graph is broken down into the highest and lowest contributions.

```{r}
graph_funct(most_data) +
  labs(title = "The Most 5 Contributing States in 2017")
  
#if the color difference is distracting, move fill out of aes() and choose a color
```

```{r}
graph_funct(least_data) +
  labs(title = "The Least 5 Contributing States in 2017")
```
 
We can see from the graphs above that Montana(MT) has by far the most contributions per person and Minnesota(MN) has the least. Montana committees spent an average of 2,031 dollars by population, and Minnesota committees spent an average of 26 dollars by population.

The difference between the most contributing state MT and the following state Rhode Island(RI) is quite big- over 1000 dollars, but the gaps between the least contributing state MI and the next less contributing state Wisconsin(WI) is very small- less than 5 dollars. 

We then looked into contribution limitations for the most and least-contributing states, to see if that may contribute to the results we saw. In Montana, there isn't a limitation on the contributions from a committee, except to Super PACs and Corporations, but the same is true for Minnesota. It is also possible that the large difference is due to various tax laws for committees in each state. If MT has low taxes for Committees, then there would be more committees, and each may be motivated to contribute more money. 

**Final Take-away:** Committees in Montana on average spend the most money on campaigns. 

Link to GitHub: https://github.com/julporto/sds192-mp2.git