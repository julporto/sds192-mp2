---
title: "avg_state_money"
author:"Julia Portocarrero & Dasom An"
output: html_document
---

This document will try to answer the possible question: how much avg $ is contributed by state? (What state contributes the most $ per population?)

```{r}
library(tidyverse)
library(dplyr)
```

```{r}
load("contributions.rda")
```


```{r}
state_contrib <- contributions %>%
  select(transaction_amt, state) %>%
  group_by(state) %>%
  summarize(avg_donation = mean(transaction_amt))

```

Load census data (made from https://www.census.gov/data/datasets/2017/demo/popest/state-total.html data): 

```{r}
census_data <- read.csv("census_Data.csv") %>%
  select(state, X2017)
```

Join together the data
```{r}
state_contrib_census <- left_join(state_contrib, census_data, by = "state", na.rm = TRUE)

test_data <- state_contrib_census %>%
  head(10)
state_contrib_census %>%
  mutate(donation_per_person = as.numeric(avg_donation)/as.numeric(X2017)) %>%
  arrange(donation_per_person)
```

Plot
```{r}
ggplot(test_data, aes(y = donation_per_person, x = X2017)) +
  geom_point() +
  #theme_light() +
  scale_x_discrete(breaks = c("0", "1", "1000000", "4000000"))
```

